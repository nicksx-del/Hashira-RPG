<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Demon Slayer RPG</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Cinzel:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* --- CORE THEME (From Character Creation) - MATCHES MOCKUP --- */
        :root {
            --bg-dark: #0a0a0f;
            --bg-panel: #141419;
            --text-main: #ffffff;
            --text-muted: #888;
            --accent-red: #d90429;
            --accent-red-hover: #ef233c;
            --accent-purple: #9d4edd;
            --accent-cyan: #00b4d8;
            --border-color: #2a2a35;
            --font-main: 'Outfit', sans-serif;
            --font-display: 'Cinzel', serif;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: var(--font-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- LEFT SIDEBAR (Navigation) --- */
        .sidebar-left {
            width: 260px;
            background: var(--bg-panel);
            border-right: 1px solid var(--border-color);
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            flex-shrink: 0;
            z-index: 10;
        }

        .app-logo {
            font-family: var(--font-display);
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-steps {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            font-weight: 500;
        }

        .nav-item:hover,
        .nav-item.active {
            background: hsla(0, 0%, 100%, 0.05);
            color: white;
        }

        .nav-item.active {
            border-right: 3px solid var(--accent-red);
            background: linear-gradient(90deg, rgba(217, 4, 41, 0.1), transparent);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
        }

        /* --- MAIN CONTENT (Center) --- */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 4rem;
            scroll-behavior: smooth;
            position: relative;
        }

        .page-header {
            margin-bottom: 3rem;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .breadcrumbs {
            color: var(--accent-red);
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .page-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            margin: 0;
            line-height: 1.1;
        }

        .page-subtitle {
            color: var(--text-muted);
            margin-top: 5px;
            font-weight: 300;
        }

        /* Sections */
        .dashboard-section {
            display: none;
            /* Hidden by default for Tabbed View */
            margin-bottom: 4rem;
            animation: fadeIn 0.3s ease-out;
        }

        .dashboard-section.active-tab {
            display: block;
            /* Shown only when active */
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 2rem;
        }

        .sec-title {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: var(--font-display);
            color: white;
        }

        /* --- RIGHT SIDEBAR (Summary) --- */
        .sidebar-right {
            width: 340px;
            background: #0e0e12;
            border-left: 1px solid var(--border-color);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            flex-shrink: 0;
            overflow-y: auto;
        }

        /* --- DASHBOARD SPECIFIC COMPONENTS --- */

        /* 1. Attributes Hexagon (Ported) */
        .attributes-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            border-radius: 50%;
        }

        .pentagram-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 1px dashed rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: spinSlow 60s linear infinite;
        }

        .stat-node {
            position: absolute;
            width: 50px;
            height: 50px;
            background: #111;
            border: 2px solid #555;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 800;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            z-index: 2;
            cursor: pointer;
            transition: all 0.2s;
        }

        .stat-node:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px currentColor;
        }

        .stat-label {
            font-size: 0.6rem;
            color: #888;
            text-transform: uppercase;
            margin-top: -2px;
        }

        /* Hexagon Positions */
        .s-str {
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            border-color: #d90429;
        }

        .s-dex {
            top: 25%;
            right: 0;
            border-color: #00b4d8;
        }

        .s-con {
            bottom: 25%;
            right: 0;
            border-color: #00ff00;
        }

        .s-int {
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-color: #9d4edd;
        }

        .s-wis {
            bottom: 25%;
            left: 0;
            border-color: #ffaa00;
        }

        .s-cha {
            top: 25%;
            left: 0;
            border-color: #ff00ff;
        }

        @keyframes spinSlow {
            to {
                transform: rotate(360deg);
            }
        }

        /* 2. Premium Bars (Right Sidebar) */
        .premium-bar {
            position: relative;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 48px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .premium-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            transition: width 0.4s ease;
        }

        .bar-hp {
            background: linear-gradient(90deg, #990000, #d90429);
        }

        .bar-pe {
            background: linear-gradient(90deg, #005f73, #00b4d8);
        }

        .bar-text-val {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.2rem;
            text-shadow: 0 0 4px black;
            z-index: 2;
        }

        .bar-btn-group {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            display: flex;
            z-index: 5;
        }

        .bar-btn {
            background: rgba(0, 0, 0, 0.3);
            border: none;
            color: white;
            width: 24px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bar-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* 3. Skills List */
        .skill-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s;
            cursor: pointer;
        }

        .skill-row:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .skill-row.proficient {
            border-left: 3px solid var(--accent-purple);
            background: rgba(157, 78, 221, 0.05);
        }

        .custom-checkbox {
            width: 14px;
            height: 14px;
            border: 1px solid #555;
            margin-right: 10px;
            border-radius: 2px;
        }

        .custom-checkbox.checked {
            background: var(--accent-purple);
            border-color: var(--accent-purple);
        }

        .roll-btn-mini {
            background: #222;
            border: 1px solid #444;
            color: #888;
            border-radius: 4px;
            padding: 4px;
            cursor: pointer;
        }

        .d20-icon {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* 4. Attack Cards */
        .attack-card {
            background: #16161a;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s;
        }

        .attack-card:hover {
            border-color: var(--accent-red);
            transform: translateY(-2px);
        }

        .atk-header {
            padding: 10px;
            background: #111;
            border-bottom: 1px solid #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .atk-name {
            font-weight: bold;
            font-family: var(--font-display);
        }

        .atk-details {
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .roll-btn {
            background: none;
            border: 1px solid #444;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            padding: 5px;
        }

        .roll-btn:hover {
            background: var(--accent-red);
            border-color: var(--accent-red);
        }

        /* 5. Inventory */
        .inv-item-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .inv-header {
            display: flex;

            /* --- INVENTORY LIST LAYOUT (MATCHING ABILITIES) --- */
            .inv-workspace {
                display: grid;
                grid-template-columns: 1fr 400px;
                /* Matching Abilities Width */
                gap: 2rem;
                height: calc(100vh - 200px);
            }

            /* Left: List (Replaces Grid) */
            .inv-list-container {
                display: flex;
                flex-direction: column;
                gap: 10px;
                overflow-y: auto;
                padding-right: 5px;
                margin-top: 20px;
            }

            .inv-row-card {
                background: #16161a;
                border: 1px solid #2a2a35;
                border-radius: 8px;
                padding: 15px;
                cursor: pointer;
                transition: all 0.2s;
                display: flex;
                gap: 15px;
                align-items: center;
                position: relative;
            }

            .inv-row-card:hover {
                transform: translateX(5px);
                background: #1f1f25;
                border-color: #444;
            }

            .inv-row-card.selected {
                border-color: var(--accent-cyan);
                background: rgba(0, 180, 216, 0.05);
            }

            .inv-row-card.equipped {
                border-left: 3px solid var(--accent-cyan);
            }

            .inv-row-icon {
                width: 48px;
                height: 48px;
                background: #111;
                border-radius: 8px;
                border: 1px solid #333;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #888;
                flex-shrink: 0;
            }

            .inv-tags {
                margin-left: auto;
                display: flex;
                gap: 5px;
                align-items: center;
            }

            .inv-tag {
                font-size: 0.65rem;
                padding: 2px 8px;
                border-radius: 4px;
                text-transform: uppercase;
                font-weight: bold;
                background: #222;
                color: #888;
                border: 1px solid #333;
            }

            .tag-rare {
                color: #00b4d8;
                border-color: rgba(0, 180, 216, 0.3);
                background: rgba(0, 180, 216, 0.1);
            }

            .tag-epic {
                color: #9d4edd;
                border-color: rgba(157, 78, 221, 0.3);
                background: rgba(157, 78, 221, 0.1);
            }

            /* Right: Details & Equip (Updated to Hero Style) */
            .inv-panel {
                background: #121215;
                border: 1px solid #333;
                border-radius: 12px;
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }

            .inv-hero {
                background: radial-gradient(circle at center, #1a1a2e 0%, #000 100%);
                padding: 2rem;
                text-align: center;
                border-bottom: 1px solid #222;
            }

            .inv-big-icon {
                width: 80px;
                height: 80px;
                margin: 0 auto 15px;
                display: flex;
                align-items: center;
                justify-content: center;
                background: #000;
                border: 2px solid var(--accent-cyan);
                border-radius: 50%;
                box-shadow: 0 0 20px rgba(0, 180, 216, 0.3);
                color: var(--accent-cyan);
                font-size: 2.5rem;
            }

            .equip-slots-mini {
                display: flex;
                justify-content: center;
                gap: 10px;
                margin-bottom: 20px;
                padding: 10px;
                background: #0e0e12;
                border-bottom: 1px solid #222;
            }

            .es-mini {
                width: 32px;
                height: 32px;
                background: #1a1a20;
                border: 1px solid #333;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #555;
            }

            .es-mini.active {
                border-color: var(--accent-cyan);
                color: var(--accent-cyan);
            }

            /* 6. Grid Layouts */
            .overview-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 3rem;
            }

            /* Utilities */
            .ds-input {
                background: rgba(0, 0, 0, 0.3);
                border: 1px solid #333;
                color: white;
                padding: 8px;
                border-radius: 4px;
                width: 100%;
                font-family: inherit;
            }

            /* Animations */
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }

                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* Portrait & Info */
            .char-portrait {
                width: 100%;
                aspect-ratio: 1;
                background: #000;
                border: 2px solid var(--accent-red);
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 3rem;
                color: #333;
                overflow: hidden;
                position: relative;
            }

            .char-portrait img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .char-info-block {
                text-align: center;
                margin-bottom: 2rem;
            }

            .vital-box {
                background: #16161a;
                border: 1px solid #333;
                padding: 10px;
                border-radius: 6px;
                margin-bottom: 10px;
            }

            .def-row {
                display: flex;
                justify-content: space-between;
                font-size: 0.9rem;
                color: #ccc;
                margin-bottom: 5px;
            }

            /* Roll Log */
            .roll-log {
                position: fixed;
                bottom: 20px;
                left: 280px;
                width: 300px;
                max-height: 200px;
                overflow-y: auto;
                display: flex;
                flex-direction: column;
                gap: 5px;
                pointer-events: none;
                z-index: 100;
            }

            .chat-msg {
                background: rgba(0, 0, 0, 0.8);
                border: 1px solid #333;
                color: white;
                padding: 8px;
                border-radius: 4px;
                font-size: 0.9rem;
                pointer-events: auto;
                animation: slideIn 0.3s;
            }

            @keyframes slideIn {
                from {
                    transform: translateX(-20px);
                    opacity: 0;
                }

                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }

            /* Modals */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.85);
                backdrop-filter: blur(5px);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .modal-overlay.open {
                display: flex !important;
            }
    </style>
</head>

<body>

    <!-- LEFT SIDEBAR -->
    <nav class="sidebar-left">
        <div class="app-logo">
            <i data-lucide="flame" style="color: var(--accent-red);"></i> Demon Slayer
        </div>

        <div class="nav-steps">
            <div
                style="font-size: 0.7rem; text-transform: uppercase; color: #555; font-weight: 700; letter-spacing: 1px; margin-bottom: 5px;">
                Menu Principal</div>

            <a href="#" class="nav-item active" onclick="showSection('overview'); return false;">
                <i data-lucide="layout-dashboard" class="nav-icon"></i>
                <span>Visão Geral</span>
            </a>
            <a href="#" class="nav-item" onclick="showSection('combat'); return false;">
                <i data-lucide="sword" class="nav-icon"></i>
                <span>Combate</span>
            </a>
            <a href="#" class="nav-item" onclick="showSection('inventory'); return false;">
                <i data-lucide="backpack" class="nav-icon"></i>
                <span>Inventário</span>
            </a>
            <a href="#" class="nav-item" onclick="showSection('abilities'); return false;">
                <i data-lucide="zap" class="nav-icon"></i>
                <span>Técnicas</span>
            </a>
            <a href="#" class="nav-item" onclick="showSection('bio'); return false;">
                <i data-lucide="scroll" class="nav-icon"></i>
                <span>Biografia</span>
            </a>
        </div>

        <div style="margin-top: auto;">
            <a href="index.html" class="nav-item" style="color: #666;">
                <i data-lucide="log-out" class="nav-icon"></i>
                <span>Sair</span>
            </a>
        </div>
    </nav>

    <!-- RIGHT SIDEBAR (Summary) -->
    <aside class="sidebar-right">
        <!-- Portrait -->
        <div class="char-portrait" id="charPortraitContainer">
            <i data-lucide="user"></i>
        </div>

        <div class="char-info-block">
            <h2 id="dispName" style="margin: 10px 0 5px 0; font-family: var(--font-display);">Sem Nome</h2>
            <div style="color: var(--accent-cyan); font-size: 0.9rem; font-weight: 600;" id="dispRank">Rank</div>
            <div style="color: #666; font-size: 0.8rem; margin-top: 5px;" id="dispClass">Classe</div>
        </div>

        <!-- Vital Bars -->
        <div>
            <div
                style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #888; margin-bottom: 4px;">
                <span>VIDA (HP)</span>
                <div>Max: <input type="number" id="hpMaxInput" class="ds-input"
                        style="width: 50px; padding: 0; background:none; border:none; text-align:right;" value="20"
                        onchange="updateMaxStats()"></div>
            </div>
            <div class="premium-bar bar-hp">
                <div class="premium-fill bar-hp" id="hpFill" style="width: 100%;"></div>
                <div class="bar-text-val">
                    <span id="hpCurrent">20</span> <span style="font-size: 0.8rem; opacity: 0.7; margin-left: 4px;"> /
                        <span id="hpPercent">100%</span></span>
                </div>
                <div class="bar-btn-group">
                    <button class="bar-btn" onclick="modHP(-1)">-</button>
                    <button class="bar-btn" onclick="modHP(1)">+</button>
                </div>
            </div>

            <div
                style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #888; margin-bottom: 4px; margin-top: 15px;">
                <span>VIGOR (PE)</span>
                <div>Max: <input type="number" id="peMaxInput" class="ds-input"
                        style="width: 50px; padding: 0; background:none; border:none; text-align:right;" value="5"
                        onchange="updateMaxStats()"></div>
            </div>
            <div class="premium-bar bar-pe">
                <div class="premium-fill bar-pe" id="peFill" style="width: 100%;"></div>
                <div class="bar-text-val">
                    <span id="peCurrent">5</span> <span style="font-size: 0.8rem; opacity: 0.7; margin-left: 4px;"> /
                        <span id="pePercent">100%</span></span>
                </div>
                <div class="bar-btn-group">
                    <button class="bar-btn" onclick="modPE(-1)">-</button>
                    <button class="bar-btn" onclick="modPE(1)">+</button>
                </div>
            </div>
        </div>

        <!-- Defense -->
        <div class="vital-box" style="margin-top: 1rem;">
            <div
                style="font-size: 0.8rem; color: var(--accent-purple); font-weight: 700; margin-bottom: 10px; text-transform: uppercase;">
                Defesa</div>
            <div class="def-row">
                <span>Classe de Armadura (CA)</span>
                <span style="color: white; font-weight: bold;" id="val-ac">10</span>
            </div>
            <div class="def-row">
                <span>Redução de Dano</span>
                <span style="color: white; font-weight: bold;" id="def-other">0</span>
            </div>
            <div class="def-row">
                <span>Iniciativa</span>
                <span style="color: white; font-weight: bold;" id="val-init">+0</span>
            </div>
        </div>

        <button onclick="saveState(); alert('Salvo!');"
            style="background: var(--accent-purple); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: bold; margin-top: auto;">
            Salvar Progresso
        </button>

    </aside>

    <!-- CONTENT AREA -->
    <main class="main-content">

        <header class="page-header">
            <div>
                <div class="breadcrumbs">Demon Slayer RPG</div>
                <h1 class="page-title">Ficha do Caçador</h1>
                <p class="page-subtitle">Gerencie seus atributos, habilidades e equipamentos.</p>
            </div>
            <!-- Hidden inputs relied on by script -->
            <input type="hidden" id="levelInput" value="1">
            <input type="hidden" id="xpInput" value="0">
        </header>

        <!-- SECTION 1: OVERVIEW (Stats + Skills) -->
        <section id="overview" class="dashboard-section">
            <div class="section-header">
                <i data-lucide="layout-dashboard" style="color: var(--accent-red);"></i>
                <span class="sec-title">Atributos e Perícias</span>
            </div>

            <div class="overview-grid">
                <!-- COL 1: ATTRIBUTES HEXAGON -->
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="attributes-container">
                        <div class="pentagram-bg"></div>
                        <!-- Nodes -->
                        <div class="stat-node s-str" onclick="rollStat('str')">
                            <span id="val-str">10</span>
                            <span class="stat-label">FOR</span>
                        </div>
                        <div class="stat-node s-dex" onclick="rollStat('dex')">
                            <span id="val-dex">10</span>
                            <span class="stat-label">AGI</span>
                        </div>
                        <div class="stat-node s-con" onclick="rollStat('con')">
                            <span id="val-con">10</span>
                            <span class="stat-label">VIG</span>
                        </div>
                        <div class="stat-node s-int" onclick="rollStat('int')">
                            <span id="val-int">10</span>
                            <span class="stat-label">INT</span>
                        </div>
                        <div class="stat-node s-wis" onclick="rollStat('wis')">
                            <span id="val-wis">10</span>
                            <span class="stat-label">PRE</span>
                        </div>
                        <div class="stat-node s-cha" onclick="rollStat('cha')">
                            <span id="val-cha">10</span>
                            <span class="stat-label">CAR</span>
                        </div>
                    </div>
                </div>

                <!-- COL 2: SKILLS -->
                <div>
                    <h3
                        style="color: white; border-bottom: 2px solid var(--accent-purple); padding-bottom: 0.5rem; margin-top:0;">
                        Perícias</h3>
                    <div id="skillsListBody" style="display: flex; flex-direction: column; gap: 0;">
                        <!-- Injected by JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: COMBAT -->
        <section id="combat" class="dashboard-section">
            <div class="section-header">
                <i data-lucide="sword" style="color: var(--accent-red);"></i>
                <span class="sec-title">Combate</span>
                <button onclick="openAttackModal()"
                    style="margin-left: auto; background: #222; border: 1px solid #444; color: white; padding: 5px 10px; border-radius: 4px; cursor: pointer;">+
                    Ataque</button>
            </div>

            <div id="attacksList"
                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
                <!-- Attacks Injected Here -->
            </div>
        </section>

        <!-- SECTION 3: INVENTORY (REVAMPED) -->
        <section id="inventory" class="dashboard-section">
            <div class="section-header">
                <i data-lucide="backpack" style="color: var(--accent-red);"></i>
                <span class="sec-title">Inventário</span>
                <button onclick="openItemModal()"
                    style="margin-left: auto; background: var(--accent-purple); border: none; color: white; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight:bold;">+
                    Adicionar Item</button>
            </div>

            <div class="inv-workspace">
                <!-- COL 1: LIBRARY -->
                <div class="inv-library">
                    <!-- Search & Filters -->
                    <div class="inv-toolbar">
                        <div style="position:relative; flex:1;">
                            <i data-lucide="search"
                                style="position:absolute; left:10px; top:10px; color:#666; width:16px;"></i>
                            <input type="text" class="inv-search" placeholder="Buscar item..." padding-left:35px;"
                                oninput="filterInventory(this.value)">
                        </div>
                        <button
                            style="background:#222; border:1px solid #333; width:40px; height:40px; border-radius:8px; cursor:pointer; color:#888;"><i
                                data-lucide="sliders-horizontal"></i></button>
                    </div>

                    <div class="inv-filters">
                        <div class="filter-tag active" onclick="setFilter('all', this)">TUDO</div>
                        <div class="filter-tag" onclick="setFilter('weapon', this)">ARMAS</div>
                        <div class="filter-tag" onclick="setFilter('armor', this)">EQUIPAMENTOS</div>
                        <div class="filter-tag" onclick="setFilter('consumable', this)">CONSUMÍVEIS</div>
                    </div>

                    <div
                        style="font-size:0.75rem; color:#666; margin-top:5px; display:flex; justify-content:space-between;">
                        <span>CAPACIDADE DA MOCHILA</span>
                        <span id="capacityText">14 / 50 kg</span>
                    </div>
                    <div class="capacity-bar-container">
                        <div class="capacity-fill" id="capacityBar" style="width: 25%;"></div>
                    </div>

                    <!-- LIST (Matched to Abilities) -->
                    <div class="inv-list-container" id="inventoryGrid">
                        <!-- Items Loaded Here (Rows) -->
                    </div>
                </div>

                <!-- COL 2: PANEL -->
                <aside class="inv-panel">
                    <!-- Mini Paper Doll (Always Visible) -->
                    <div class="equip-slots-mini">
                        <div class="es-mini" id="slot-head" title="Cabeça"><i data-lucide="smile"></i></div>
                        <div class="es-mini" id="slot-torso" title="Tronco"><i data-lucide="shirt"></i></div>
                        <div class="es-mini" id="slot-hands" title="Mãos"><i data-lucide="hand"></i></div>
                        <div class="es-mini" id="slot-weapon" title="Arma"><i data-lucide="sword"></i></div>
                        <div class="es-mini" id="slot-legs" title="Pernas"><i data-lucide="footprints"></i></div>
                    </div>

                    <!-- SELECTED ITEM DETAILS -->
                    <div id="itemDetailContainer" style="display:none; flex-direction:column; flex:1;">
                        <!-- Populated by JS -->
                    </div>

                    <!-- Empty State for Details -->
                    <div id="itemDetailEmpty"
                        style="flex:1; display:flex; align-items:center; justify-content:center; color:#444; margin: 20px; border:1px dashed #333; border-radius:8px;">
                        Selecione um item
                    </div>
                </aside>
            </div>
        </section>

        <!-- SECTION 4: ABILITIES -->
        <section id="abilities" class="dashboard-section">
            <div class="section-header">
                <i data-lucide="zap" style="color: var(--accent-red);"></i>
                <span class="sec-title">Habilidades & Técnicas</span>
            </div>
            <div id="tab-abilities" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <!-- Abilities -->
            </div>

            <h3 style="margin-top: 2rem; color: var(--accent-cyan);">Respiração</h3>
            <div id="breathingContent"></div>
        </section>

        <!-- SECTION 5: BIO -->
        <section id="bio" class="dashboard-section">
            <div class="section-header">
                <i data-lucide="scroll" style="color: var(--accent-red);"></i>
                <span class="sec-title">Biografia</span>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                <div>
                    <label style="color:#888; display:block; margin-bottom:5px;">História</label>
                    <textarea id="desc-story" class="ds-input" style="height: 150px; width: 100%;"></textarea>
                </div>
                <div>
                    <label style="color:#888; display:block; margin-bottom:5px;">Anotações</label>
                    <textarea id="desc-notes" class="ds-input" style="height: 150px; width: 100%;"></textarea>
                </div>
            </div>
            <div style="margin-top: 1rem;">
                <label style="color:#888;">Dinheiro (Yenes)</label>
                <input type="text" id="desc-money" class="ds-input" value="0">
            </div>
            <button onclick="saveDescription()"
                style="margin-top: 1rem; background: #222; color: white; padding: 8px 16px; border: 1px solid #444; cursor: pointer;">Salvar
                Bio</button>
        </section>

        <!-- Spacer -->
        <div style="height: 50px;"></div>
    </main>

    <!-- ROLLING LOG OVERLAY (For chat messages) -->
    <div class="roll-log" id="chatContent" style="display: flex; flex-direction:column-reverse;"></div>

    <!-- MODALS (Preserved Structure from Dashboard.js expectations) -->
    <!-- PREMIUM ITEM MODAL -->
    <div id="itemModal" class="modal-overlay" style="display:none;">
        <div class="premium-modal">
            <div class="modal-top">
                <h3 class="modal-title"><i data-lucide="package-plus"></i> Forja & Suprimentos</h3>
                <button class="modal-close" onclick="closeItemModal()"><i data-lucide="x"></i></button>
            </div>

            <div class="modal-content-area">
                <!-- Categories -->
                <nav class="modal-cats">
                    <button class="cat-btn active" onclick="filterModal('weapon', this)"><i data-lucide="sword"></i>
                        Armas</button>
                    <button class="cat-btn" onclick="filterModal('armor', this)"><i data-lucide="shield"></i>
                        Proteção</button>
                    <button class="cat-btn" onclick="filterModal('consumable', this)"><i
                            data-lucide="flask-conical"></i> Consumíveis</button>
                    <button class="cat-btn" onclick="filterModal('misc', this)"><i data-lucide="box"></i>
                        Outros</button>
                </nav>

                <!-- Items Grid -->
                <div class="modal-picker">
                    <input type="text" id="pickerSearch" class="ds-input" placeholder="Buscar item..."
                        style="margin-bottom:1rem;" oninput="searchModal(this.value)">
                    <div id="pickerGrid" class="picker-grid">
                        <!-- Items Loaded Here -->
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <span style="font-size:0.8rem; color:#666; margin-right:auto;">Clique para adicionar ao
                    inventário</span>
                <button onclick="closeItemModal()"
                    style="background:#333; color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer;">Fechar</button>
            </div>
        </div>
    </div>

    <div id="attackModal" class="modal-overlay" style="display:none;">
        <div style="background:#1a1a1a; padding:2rem; width:400px; border:1px solid #333; border-radius:8px;">
            <h3>Novo Ataque</h3>
            <input type="text" id="newAtkName" placeholder="Nome" class="ds-input" style="margin-bottom:10px;">
            <input type="text" id="newAtkDmg" placeholder="Dano (ex: 1d6+2)" class="ds-input"
                style="margin-bottom:10px;">
            <input type="text" id="newAtkType" placeholder="Tipo (ex: Cortante)" class="ds-input"
                style="margin-bottom:10px;">
            <button onclick="saveCustomAttack()" style="width:100%; padding:10px;">Salvar</button>
            <button onclick="closeAttackModal()"
                style="width:100%; margin-top:5px; background:none; color:#888; border:none; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <div id="abilityModal" class="modal-overlay" style="display:none;">
        <div style="background:#1a1a1a; padding:2rem; width:400px; border:1px solid #333; border-radius:8px;">
            <h3>Nova Habilidade</h3>
            <input type="text" id="newAbilName" placeholder="Nome" class="ds-input" style="margin-bottom:10px;">
            <textarea id="newAbilDesc" placeholder="Descrição" class="ds-input"
                style="margin-bottom:10px; height:80px;"></textarea>
            <button onclick="saveCustomAbility()" style="width:100%; padding:10px;">Salvar</button>
            <button onclick="closeAbilityModal()"
                style="width:100%; margin-top:5px; background:none; color:#888; border:none; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="dashboard.js"></script>
    <script>
        // Tab Navigation Logic
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.dashboard-section').forEach(el => {
                el.classList.remove('active-tab');
            });

            // Show target section
            const target = document.getElementById(sectionId);
            if (target) target.classList.add('active-tab');

            // Update Sidebar State
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active');
            });

            // Find the button (approximate match by onclick content)
            const activeNav = Array.from(document.querySelectorAll('.nav-item')).find(el => {
                const clickAttr = el.getAttribute('onclick');
                return clickAttr && clickAttr.includes(sectionId);
            });

            if (activeNav) activeNav.classList.add('active');
        }

        // Initialize Default Tab
        document.addEventListener('DOMContentLoaded', () => {
            showSection('overview');
        });

        // Initialize Lucide
        if (window.lucide) lucide.createIcons();
    </script>
</body>

</html>